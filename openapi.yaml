openapi: 3.1.0
info:
  title: Clisonix Cloud API - Part of Webultrathinking Euroweb
  version: '1.0.0'
  description: |
    Clisonix Cloud API – Enterprise-grade neuro-audio, EEG processing, brain-sync engine,
    billing integration, and real-time system observability.
    
    **Key Features:**
    - Neural harmonic synchronization engine
    - EEG signal processing and analysis
    - Brain-adaptive music generation
    - Real-time data streaming (ALBA)
    - Multi-channel payment integration
    - Industrial-grade system monitoring
    
    **Security:** All endpoints require Bearer JWT authentication.
  contact:
    name: Clisonix Support
    url: https://clisonix.cloud/support
    email: support@clisonix.cloud
  license:
    name: Proprietary
    url: https://clisonix.cloud/license
  x-logo:
    url: https://clisonix.cloud/logo.png

servers:
  - url: http://localhost:8000
    description: Local Development
    variables: {}
  - url: https://api.clisonix.cloud
    description: Production
    variables: {}
  - url: https://sandbox.clisonix.cloud
    description: Sandbox Testing
    variables: {}

tags:
  - name: Core
    description: System health and status endpoints
  - name: Brain
    description: Neural harmonic processing and analysis
  - name: Audio
    description: Audio processing and synthesis
  - name: EEG
    description: EEG data collection and processing
  - name: ALBA
    description: Advanced Low Bandwidth Archive data streams
  - name: Billing
    description: Payment processing integration
  - name: ASI
    description: ASI Trinity autonomous system interface
  - name: Utility
    description: Database and cache utilities

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: 'JWT Bearer token. Format: Authorization: Bearer <token>'
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: Alternative API key authentication
    oauth2:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: /auth/token
          scopes:
            read: Read access to resources
            write: Write access to resources
            admin: Administrative access

  schemas:
    ErrorResponse:
      type: object
      required:
        - error
      properties:
        error:
          type: object
          properties:
            code:
              type: string
              enum:
                - INVALID_REQUEST
                - AUTHENTICATION_FAILED
                - UNAUTHORIZED
                - NOT_FOUND
                - VALIDATION_ERROR
                - RATE_LIMIT_EXCEEDED
                - INTERNAL_ERROR
                - SERVICE_UNAVAILABLE
            message:
              type: string
            details:
              type: string
              nullable: true
            timestamp:
              type: string
              format: date-time
            request_id:
              type: string

    HealthResponse:
      type: object
      properties:
        service:
          type: string
          example: 'clisonix-cloud'
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
          example: 'healthy'
        version:
          type: string
          example: '1.0.0'
        timestamp:
          type: string
          format: date-time
        instance_id:
          type: string
        uptime_app_seconds:
          type: integer
          format: int64
        system:
          $ref: '#/components/schemas/SystemMetrics'
        redis:
          $ref: '#/components/schemas/ServiceStatus'
        database:
          $ref: '#/components/schemas/ServiceStatus'
        environment:
          type: string
          enum: [development, staging, production]

    SystemMetrics:
      type: object
      properties:
        cpu_percent:
          type: number
          format: double
          minimum: 0
          maximum: 100
        memory_percent:
          type: number
          format: double
          minimum: 0
          maximum: 100
        memory_total:
          type: number
          format: double
        memory_available:
          type: number
          format: double
        disk_percent:
          type: number
          format: double
          minimum: 0
          maximum: 100
        disk_total:
          type: number
          format: double
        net_bytes_sent:
          type: integer
          format: int64
        net_bytes_recv:
          type: integer
          format: int64
        processes:
          type: integer
        hostname:
          type: string
        boot_time:
          type: number
          format: double
        uptime_seconds:
          type: number
          format: double

    ServiceStatus:
      type: object
      properties:
        status:
          type: string
          enum: [connected, disconnected, degraded]
        message:
          type: string
        connected_clients:
          type: integer
        used_memory:
          type: string
        uptime_seconds:
          type: integer
        response_time_ms:
          type: number

    StatusResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        instance_id:
          type: string
        status:
          type: string
          enum: [operational, degraded, maintenance]
        uptime:
          type: string
          example: '5d 12h 34m 56s'
        memory:
          type: object
          properties:
            used:
              type: integer
              format: int64
            total:
              type: integer
              format: int64
        system:
          $ref: '#/components/schemas/SystemMetrics'
        redis:
          $ref: '#/components/schemas/ServiceStatus'
        database:
          $ref: '#/components/schemas/ServiceStatus'
        storage_dir:
          type: string
        dependencies:
          type: object
          additionalProperties:
            type: object
            properties:
              status:
                type: string
              version:
                type: string

    AuthLoginRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          description: User email address
        password:
          type: string
          format: password
          description: User password

    AuthLoginResponse:
      type: object
      properties:
        token:
          type: string
          description: JWT access token
        token_type:
          type: string
          default: bearer
          description: Type of token
        expires_in:
          type: integer
          description: Token expiration time in seconds
          example: 3600
        refresh_token:
          type: string
          description: Token for refreshing access
        api_key:
          type: string
          nullable: true
          description: Optional API key for this user

    AuthRefreshRequest:
      type: object
      required: [refresh_token]
      properties:
        refresh_token:
          type: string
          description: Refresh token from login

    AuthRefreshResponse:
      type: object
      properties:
        token:
          type: string
          description: New JWT access token
        token_type:
          type: string
          default: bearer
        expires_in:
          type: integer
          example: 3600

    ApiKeyCreateRequest:
      type: object
      properties:
        label:
          type: string
          description: Human-readable label for the API key
          example: "server-side integration"

    ApiKeyCreateResponse:
      type: object
      properties:
        api_key:
          type: string
          description: Generated API key
        label:
          type: string
        created_at:
          type: string
          format: date-time

    AskRequest:
      type: object
      required:
        - question
      properties:
        question:
          type: string
          minLength: 1
          maxLength: 2000
          description: Question or query for the AI assistant
        context:
          type: string
          nullable: true
          maxLength: 5000
          description: Optional context to help answer the question
        include_details:
          type: boolean
          default: true
          description: Include detailed analysis in response

    AskResponse:
      type: object
      properties:
        answer:
          type: string
          description: AI-generated answer
        timestamp:
          type: string
          format: date-time
        modules_used:
          type: array
          items:
            type: string
          example: ['brain', 'cortex', 'harmony']
        processing_time_ms:
          type: integer
          minimum: 0
        details:
          type: object
          additionalProperties: true
          nullable: true

    BrainHarmonyResponse:
      type: object
      properties:
        fundamental_frequency:
          type: number
          description: F0 frequency in Hz
        overtones:
          type: array
          items:
            type: number
        chord_estimation:
          type: string
          example: 'Cmaj7'
        harmonic_progression:
          type: array
          items:
            type: string
        tonal_center:
          type: string
        scale_mode:
          type: string
          enum: [major, minor, dorian, phrygian, lydian, mixolydian, locrian]
        alpha_harmonic_index:
          type: number
        confidence:
          type: number
          format: double
          minimum: 0
          maximum: 1

    BrainSyncMusicRequest:
      type: object
      required:
        - file
        - mode
      properties:
        file:
          type: string
          format: binary
          description: Audio file for analysis
        mode:
          type: string
          enum: [relax, focus, sleep, motivation, creativity, recovery]
          description: Brain-sync mode
        duration_seconds:
          type: integer
          nullable: true
          minimum: 10
          maximum: 3600

    HarmonicPersonalityResponse:
      type: object
      properties:
        key:
          type: string
          example: 'C major'
        bpm:
          type: number
        harmonic_fingerprint:
          type: array
          items:
            type: number
        emotional_tone:
          type: string
          enum: [calm, energetic, melancholic, joyful, neutral]
        personality_archetype:
          type: string
          enum: [explorer, mentor, sage, innocent, lover, creator, ruler, magician, hero, outlaw, everyman, jester]
        confidence:
          type: number
          format: double
          minimum: 0
          maximum: 1

    AlbaStreamStartRequest:
      type: object
      required:
        - stream_id
      properties:
        stream_id:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[a-zA-Z0-9_-]+$'
          description: Unique stream identifier
        description:
          type: string
          maxLength: 500
          nullable: true
        sampling_rate_hz:
          type: integer
          minimum: 1
          maximum: 500000
          default: 256
          description: Sampling rate in Hz
        channels:
          type: array
          items:
            type: string
            minLength: 1
          minItems: 1
          maxItems: 64
          description: List of channel names (e.g., ['Fp1', 'Fp2', 'Cz'])
        metadata:
          type: object
          additionalProperties:
            oneOf:
              - type: string
              - type: number
              - type: boolean

    AlbaStreamResponse:
      type: object
      properties:
        message:
          type: string
        stream_id:
          type: string
        status:
          type: string
          enum: [started, stopped, paused, error]
        timestamp:
          type: string
          format: date-time

    AlbaStreamsListResponse:
      type: object
      properties:
        active_streams:
          type: object
          additionalProperties:
            type: object
            properties:
              stream_id:
                type: string
              status:
                type: string
              sampling_rate_hz:
                type: integer
              channels:
                type: array
                items:
                  type: string
              started_at:
                type: string
                format: date-time
        total_streams:
          type: integer

    AlbaStreamDataResponse:
      type: object
      properties:
        stream_id:
          type: string
        data_points:
          type: array
          items:
            type: object
            additionalProperties:
              oneOf:
                - type: number
                - type: string
        metadata:
          type: object
          additionalProperties: true
        timestamp:
          type: string
          format: date-time

    AlbaMetricsResponse:
      type: object
      properties:
        total_data_points:
          type: integer
          format: int64
        active_streams:
          type: integer
        total_streams:
          type: integer
        data_rate_hz:
          type: number
          description: Current data ingestion rate
        storage_usage_mb:
          type: number
        uptime_hours:
          type: number

    AlbaHealthResponse:
      type: object
      properties:
        module:
          type: string
          example: 'ALBA'
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        timestamp:
          type: string
          format: date-time
        version:
          type: string
        streams_active:
          type: integer
        storage_health:
          type: string
          enum: [ok, warning, critical]

    PayPalOrderRequest:
      type: object
      required:
        - intent
        - purchase_units
      properties:
        intent:
          type: string
          enum: [CAPTURE, AUTHORIZE]
        purchase_units:
          type: array
          minItems: 1
          items:
            type: object
            required:
              - amount
            properties:
              amount:
                type: object
                required:
                  - currency_code
                  - value
                properties:
                  currency_code:
                    type: string
                    pattern: '^[A-Z]{3}$'
                    example: 'EUR'
                  value:
                    type: string
                    pattern: '^\d+\.\d{2}$'
                    example: '10.00'
              description:
                type: string
                nullable: true

    StripePaymentIntentRequest:
      type: object
      required:
        - amount
        - currency
      properties:
        amount:
          type: integer
          minimum: 1
          description: Amount in smallest currency unit (cents)
        currency:
          type: string
          pattern: '^[a-z]{3}$'
          example: 'eur'
        payment_method_types:
          type: array
          items:
            type: string
            enum: [card, sepa_debit, bank_transfer, klarna, paypal]
          nullable: true
        description:
          type: string
          maxLength: 1000
          nullable: true
        customer:
          type: string
          nullable: true
        metadata:
          type: object
          additionalProperties:
            type: string
          nullable: true

    SepaInitiateRequest:
      type: object
      required:
        - debtor_iban
        - creditor_iban
        - amount
      properties:
        debtor_iban:
          type: string
          pattern: '^[A-Z]{2}\d{2}[A-Z0-9]+$'
          description: Debtor IBAN
        creditor_iban:
          type: string
          pattern: '^[A-Z]{2}\d{2}[A-Z0-9]+$'
          description: Creditor IBAN
        amount:
          type: string
          pattern: '^\d+\.\d{2}$'
          example: '100.00'
        currency:
          type: string
          pattern: '^[A-Z]{3}$'
          default: 'EUR'
        remittance_information:
          type: string
          maxLength: 500
          nullable: true

    AsiExecuteRequest:
      type: object
      required:
        - command
      properties:
        command:
          type: string
          minLength: 1
          maxLength: 1000
          description: Command to execute
        agent:
          type: string
          default: 'trinity'
          enum: [trinity, cortex, harmony, sync]
        parameters:
          type: object
          additionalProperties: true

    PingResponse:
      type: object
      properties:
        status:
          type: string
          enum: [ok, failed]
        timestamp:
          type: string
          format: date-time
        response_time_ms:
          type: number

  requestBodies:
    BinaryFileUpload:
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            required:
              - file
            properties:
              file:
                type: string
                format: binary
                description: Binary file (audio, EEG data, etc.)

  responses:
    UnauthorizedError:
      description: Authentication token is missing or invalid
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    ForbiddenError:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    NotFoundError:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    ValidationError:
      description: Request validation failed
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    RateLimitError:
      description: Rate limit exceeded
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
      headers:
        X-RateLimit-Limit:
          schema:
            type: integer
        X-RateLimit-Remaining:
          schema:
            type: integer
        X-RateLimit-Reset:
          schema:
            type: string
            format: date-time

    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    ServiceUnavailableError:
      description: Service temporarily unavailable
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

security:
  - bearerAuth: []
  - apiKey: []

paths:
  /auth/login:
    post:
      summary: User Login
      tags:
        - Core
      description: Authenticate user with email & password and return JWT + refresh token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthLoginRequest'
      responses:
        '200':
          description: Successful login
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthLoginResponse'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/refresh:
    post:
      summary: Refresh Token
      tags:
        - Core
      description: Refresh JWT access token using refresh_token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthRefreshRequest'
      responses:
        '200':
          description: Successful token refresh
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthRefreshResponse'
        '401':
          description: Invalid refresh token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/api-key:
    post:
      summary: Create API Key
      tags:
        - Core
      description: Create a new API key for the authenticated user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApiKeyCreateRequest'
      responses:
        '200':
          description: API key created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKeyCreateResponse'
        '401':
          description: Unauthorized - authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /:
    get:
      summary: Root endpoint
      tags:
        - Utility
      security: []
      description: API root information
      responses:
        '200':
          description: API root information
          content:
            application/json:
              schema:
                type: object
                properties:
                  version:
                    type: string
                  title:
                    type: string
                  documentation:
                    type: string

  /health:
    get:
      summary: Health check
      tags:
        - Core
      description: Comprehensive health check with system metrics
      responses:
        '200':
          description: System is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '503':
          $ref: '#/components/responses/ServiceUnavailableError'

  /status:
    get:
      summary: Full system status
      tags:
        - Core
      description: Complete system status including all subsystems
      responses:
        '200':
          description: System status retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '503':
          $ref: '#/components/responses/ServiceUnavailableError'

  /api/system-status:
    get:
      summary: System status (API proxy)
      tags:
        - Core
      description: Frontend API proxy for /status endpoint
      responses:
        '200':
          description: System status retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /api/ask:
    post:
      summary: Ask AI assistant
      tags:
        - Brain
      description: Query the AI assistant with optional context
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AskRequest'
      responses:
        '200':
          description: Question answered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AskResponse'
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '429':
          $ref: '#/components/responses/RateLimitError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /neural-symphony:
    get:
      summary: Generate EEG alpha wave audio
      tags:
        - Audio
      description: Generate WAV audio from synthetic EEG alpha wave signal
      responses:
        '200':
          description: WAV audio stream
          content:
            audio/wav:
              schema:
                type: string
                format: binary
        '400':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /brain/youtube/insight:
    get:
      summary: YouTube video analysis
      tags:
        - Brain
      description: |
        Analyze YouTube video for:
        - Emotional tone
        - Core insights
        - Trend potential
        - Target audience
        - Brain-sync recommendations
      parameters:
        - name: video_id
          in: query
          required: true
          schema:
            type: string
            minLength: 1
          description: YouTube video ID
      responses:
        '200':
          description: Analysis completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  video_id:
                    type: string
                  metadata:
                    type: object
                  emotional_tone:
                    type: string
                  core_insights:
                    type: array
                    items:
                      type: string
                  trend_potential:
                    type: number
                    minimum: 0
                    maximum: 1
                  target_audience:
                    type: string
                  recommended_brain_sync:
                    type: string
        '422':
          $ref: '#/components/responses/ValidationError'

  /brain/energy/check:
    post:
      summary: Daily energy check
      tags:
        - Audio
      description: |
        Analyze audio for:
        - Dominant frequency
        - Vocal tension
        - Emotional tone
        - Energy level (0–100)
        - Recommended quick sound
      requestBody:
        $ref: '#/components/requestBodies/BinaryFileUpload'
      responses:
        '200':
          description: Energy analysis completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  dominant_frequency:
                    type: number
                  vocal_tension:
                    type: number
                  emotional_tone:
                    type: string
                  energy_level:
                    type: integer
                    minimum: 0
                    maximum: 100
                  recommended_sound:
                    type: string
        '422':
          $ref: '#/components/responses/ValidationError'

  /brain/moodboard/generate:
    post:
      summary: Generate neural moodboard
      tags:
        - Brain
      description: |
        Generate moodboard from text and/or media:
        - Color palette
        - Dominant color
        - Emotion analysis
        - Harmonics profile
        - Personality archetype
        - Inspirational quote
      parameters:
        - name: text
          in: query
          schema:
            type: string
            maxLength: 2000
          description: Text description
        - name: mood
          in: query
          schema:
            type: string
            enum: [calm, focus, happy, sad, dreamy, energetic]
          description: Mood filter
      requestBody:
        required: false
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: Optional image or audio file
      responses:
        '200':
          description: Moodboard generated
          content:
            application/json:
              schema:
                type: object
                properties:
                  color_palette:
                    type: array
                    items:
                      type: string
                      pattern: '^#[0-9A-F]{6}$'
                  dominant_color:
                    type: string
                  emotion_analysis:
                    type: object
                  harmonics:
                    type: array
                    items:
                      type: number
                  personality_archetype:
                    type: string
                  inspirational_quote:
                    type: string
        '422':
          $ref: '#/components/responses/ValidationError'

  /brain/music/brainsync:
    post:
      summary: Generate brain-sync music
      tags:
        - Audio
      description: |
        Generate personalized brain-sync music.
        
        **Modes:**
        - relax: Reduce stress, meditation
        - focus: Concentration, productivity
        - sleep: Deep sleep induction
        - motivation: Energy boost
        - creativity: Innovation, flow state
        - recovery: Physical/mental recovery
      parameters:
        - name: mode
          in: query
          required: true
          schema:
            type: string
            enum: [relax, focus, sleep, motivation, creativity, recovery]
          description: Brain-sync mode
        - name: duration_seconds
          in: query
          schema:
            type: integer
            minimum: 10
            maximum: 3600
            default: 600
          description: Duration in seconds
      requestBody:
        $ref: '#/components/requestBodies/BinaryFileUpload'
      responses:
        '200':
          description: Music generated
          content:
            audio/wav:
              schema:
                type: string
                format: binary
        '422':
          $ref: '#/components/responses/ValidationError'

  /brain/scan/harmonic:
    post:
      summary: Harmonic personality scan
      tags:
        - Audio
      description: |
        Extract personality profile from audio:
        - Key and scale
        - BPM/Tempo
        - Harmonic fingerprint
        - Emotional tone
        - Personality archetype
      requestBody:
        $ref: '#/components/requestBodies/BinaryFileUpload'
      responses:
        '200':
          description: Scan completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HarmonicPersonalityResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

  /brain/harmony:
    post:
      summary: Analyze harmonic structure
      tags:
        - Audio
      description: |
        Detailed harmonic analysis of audio:
        - Fundamental frequency (F0)
        - Overtone series
        - Chord estimation
        - Harmonic progression
        - Tonal center and scale mode
        - Alpha/Harmonic index
      requestBody:
        $ref: '#/components/requestBodies/BinaryFileUpload'
      responses:
        '200':
          description: Harmonic analysis completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BrainHarmonyResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

  /brain/sync:
    post:
      summary: Full neural-harmonic synchronization
      tags:
        - Brain
      description: |
        Complete pipeline:
        1. YouTube metadata analysis (if video_id provided)
        2. Audio harmonic analysis (if file provided)
        3. Neural synchronization
        4. Personalized output generation
      requestBody:
        required: false
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                youtube_video_id:
                  type: string
                  description: YouTube video ID
                file:
                  type: string
                  format: binary
                  description: Audio file for analysis
      responses:
        '200':
          description: Synchronization completed
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true
        '422':
          $ref: '#/components/responses/ValidationError'

  /brain/cortex-map:
    get:
      summary: Get neural architecture map
      tags:
        - Brain
      description: Returns complete neural network topology and connections
      responses:
        '200':
          description: Cortex map retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  modules:
                    type: array
                    items:
                      type: object
                  connections:
                    type: array
                    items:
                      type: object
                  active_signals:
                    type: array
                    items:
                      type: object

  /brain/temperature:
    get:
      summary: Get module thermal stress
      tags:
        - Brain
      description: Per-module temperature and CPU thermal metrics
      responses:
        '200':
          description: Temperature data retrieved
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: object
                  properties:
                    cpu_temp:
                      type: number
                    stress_level:
                      type: number
                      minimum: 0
                      maximum: 100

  /brain/queue:
    get:
      summary: Get processing queue status
      tags:
        - Brain
      description: Queue metrics for ingestion, processing, and synthesis
      responses:
        '200':
          description: Queue status retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  ingestion_queue:
                    type: integer
                  processing_queue:
                    type: integer
                  synthesis_queue:
                    type: integer

  /brain/threads:
    get:
      summary: Get thread information
      tags:
        - Brain
      description: Active threads, CPU usage, and processing routines
      responses:
        '200':
          description: Thread info retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  active_threads:
                    type: integer
                  cpu_usage:
                    type: number
                  routines:
                    type: array
                    items:
                      type: object

  /brain/neural-load:
    get:
      summary: Get industrial neural load metrics
      tags:
        - Brain
      description: Per-module processing load and utilization
      responses:
        '200':
          description: Neural load retrieved
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: number

  /brain/errors:
    get:
      summary: Get system errors
      tags:
        - Brain
      description: Real-time cognitive and system errors from Brain Engine
      responses:
        '200':
          description: Error log retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    timestamp:
                      type: string
                      format: date-time
                    module:
                      type: string
                    error:
                      type: string
                    severity:
                      type: string
                      enum: [info, warning, error, critical]

  /brain/live:
    get:
      summary: Stream live brain metrics
      tags:
        - Brain
      description: Server-Sent Events (SSE) stream with real-time metrics (0.5s updates)
      responses:
        '200':
          description: SSE stream connected
          content:
            text/event-stream:
              schema:
                type: object
                properties:
                  timestamp:
                    type: string
                    format: date-time
                  cpu_percent:
                    type: number
                  memory_percent:
                    type: number
                  active_threads:
                    type: integer
                  queue_size:
                    type: integer

  /brain/restart:
    post:
      summary: Restart cognitive modules
      tags:
        - Brain
      description: Safely restart brain modules without stopping API
      responses:
        '200':
          description: Restart initiated
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  restart_duration_ms:
                    type: integer

  /api/uploads/eeg/process:
    post:
      summary: Process EEG file
      tags:
        - EEG
      description: Upload and process EEG data file
      requestBody:
        $ref: '#/components/requestBodies/BinaryFileUpload'
      responses:
        '200':
          description: EEG processed
          content:
            application/json:
              schema:
                type: object
                properties:
                  file_name:
                    type: string
                  channels:
                    type: array
                    items:
                      type: string
                  sampling_rate:
                    type: number
                  duration_seconds:
                    type: number
                  quality_metrics:
                    type: object
        '422':
          $ref: '#/components/responses/ValidationError'

  /api/uploads/audio/process:
    post:
      summary: Process audio file
      tags:
        - Audio
      description: Upload and process audio file
      requestBody:
        $ref: '#/components/requestBodies/BinaryFileUpload'
      responses:
        '200':
          description: Audio processed
          content:
            application/json:
              schema:
                type: object
                properties:
                  file_name:
                    type: string
                  duration_seconds:
                    type: number
                  sample_rate:
                    type: integer
                  channels:
                    type: integer
                  bit_depth:
                    type: integer
        '422':
          $ref: '#/components/responses/ValidationError'

  /billing/paypal/order:
    post:
      summary: Create PayPal order
      tags:
        - Billing
      description: Create new PayPal order (sandbox/live based on configuration)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PayPalOrderRequest'
      responses:
        '200':
          description: Order created
          content:
            application/json:
              schema:
                type: object
                properties:
                  order_id:
                    type: string
                  status:
                    type: string
                  links:
                    type: array
                    items:
                      type: object
        '422':
          $ref: '#/components/responses/ValidationError'
        '501':
          description: Not implemented
        '502':
          $ref: '#/components/responses/InternalServerError'

  /billing/paypal/capture/{order_id}:
    post:
      summary: Capture PayPal payment
      tags:
        - Billing
      description: Capture previously authorized PayPal payment
      parameters:
        - name: order_id
          in: path
          required: true
          schema:
            type: string
            minLength: 1
          description: PayPal order ID
      responses:
        '200':
          description: Payment captured
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  capture_id:
                    type: string
        '422':
          $ref: '#/components/responses/ValidationError'
        '501':
          description: Not implemented
        '502':
          $ref: '#/components/responses/InternalServerError'

  /billing/stripe/payment-intent:
    post:
      summary: Create Stripe payment intent
      tags:
        - Billing
      description: Create Stripe PaymentIntent for payment processing
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StripePaymentIntentRequest'
      responses:
        '200':
          description: Payment intent created
          content:
            application/json:
              schema:
                type: object
                properties:
                  client_secret:
                    type: string
                  payment_intent_id:
                    type: string
                  status:
                    type: string
                    enum: [requires_payment_method, requires_confirmation, requires_action, processing, requires_capture, canceled, succeeded]
                  amount:
                    type: integer
                  currency:
                    type: string
        '422':
          $ref: '#/components/responses/ValidationError'
        '501':
          description: Not implemented
        '502':
          $ref: '#/components/responses/InternalServerError'

  /billing/sepa/initiate:
    post:
      summary: Initiate SEPA transfer
      tags:
        - Billing
      description: Initialize SEPA bank transfer (placeholder - returns 501 until configured)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SepaInitiateRequest'
      responses:
        '200':
          description: SEPA initiated
          content:
            application/json:
              schema:
                type: object
                properties:
                  transaction_id:
                    type: string
                  status:
                    type: string
        '422':
          $ref: '#/components/responses/ValidationError'
        '501':
          description: SEPA integration not yet configured

  /db/ping:
    get:
      summary: Database connectivity test
      tags:
        - Utility
      description: Test PostgreSQL database connection
      responses:
        '200':
          description: Database connected
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PingResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '501':
          description: Database not available

  /redis/ping:
    get:
      summary: Redis connectivity test
      tags:
        - Utility
      description: Test Redis cache connection
      responses:
        '200':
          description: Redis connected
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PingResponse'
        '500':
          $ref: '#/components/responses/InternalServerError'
        '501':
          description: Redis not available

  /asi/status:
    get:
      summary: ASI Trinity status
      tags:
        - ASI
      description: ASI Trinity autonomous system status
      responses:
        '200':
          description: Status retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  system:
                    type: string
                  status:
                    type: string
                  version:
                    type: string
                  modules:
                    type: array
                    items:
                      type: object

  /asi/health:
    get:
      summary: ASI Trinity health check
      tags:
        - ASI
      description: ASI system health and diagnostics
      responses:
        '200':
          description: Health check completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  diagnostics:
                    type: object

  /asi/execute:
    post:
      summary: Execute ASI command
      tags:
        - ASI
      description: Execute command through ASI Trinity system
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AsiExecuteRequest'
      responses:
        '200':
          description: Command executed
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: string
                  execution_time_ms:
                    type: integer
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'

  /api/alba/status:
    get:
      summary: ALBA module status
      tags:
        - ALBA
      description: Get ALBA data collection module status
      responses:
        '200':
          description: Status retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  module:
                    type: string
                    enum: [ALBA]
                  status:
                    type: string
                    enum: [active, idle, error]
                  streams_count:
                    type: integer
                  data_collection:
                    type: string
                  timestamp:
                    type: string
                    format: date-time

  /api/alba/alba/cbor:
    get:
      summary: Get CBOR data
      tags:
        - ALBA
      description: Retrieve ALBA data in CBOR format
      responses:
        '200':
          description: CBOR data stream
          content:
            application/cbor:
              schema:
                type: string
                format: binary

    post:
      summary: Post CBOR data
      tags:
        - ALBA
      description: Submit data in CBOR format
      requestBody:
        required: true
        content:
          application/cbor:
            schema:
              type: string
              format: binary
      responses:
        '200':
          description: CBOR data accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string

  /api/alba/streams/start:
    post:
      summary: Start data collection stream
      tags:
        - ALBA
      description: Create and start new ALBA data stream
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AlbaStreamStartRequest'
      responses:
        '200':
          description: Stream started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AlbaStreamResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

  /api/alba/streams/{stream_id}/stop:
    post:
      summary: Stop data collection stream
      tags:
        - ALBA
      description: Stop active ALBA data stream
      parameters:
        - name: stream_id
          in: path
          required: true
          schema:
            type: string
            minLength: 1
          description: Stream identifier
      responses:
        '200':
          description: Stream stopped
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AlbaStreamResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

  /api/alba/streams:
    get:
      summary: Get all active streams
      tags:
        - ALBA
      description: List all active data collection streams
      responses:
        '200':
          description: Streams list retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AlbaStreamsListResponse'

  /api/alba/streams/{stream_id}/data:
    get:
      summary: Get stream data
      tags:
        - ALBA
      description: Retrieve collected data from specific stream
      parameters:
        - name: stream_id
          in: path
          required: true
          schema:
            type: string
            minLength: 1
          description: Stream identifier
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 10000
            default: 100
          description: Maximum number of data points
      responses:
        '200':
          description: Stream data retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AlbaStreamDataResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

  /api/alba/config:
    post:
      summary: Update ALBA configuration
      tags:
        - ALBA
      description: Update data collection configuration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - settings
              properties:
                settings:
                  type: object
                  additionalProperties:
                    oneOf:
                      - type: string
                      - type: number
                      - type: boolean
      responses:
        '200':
          description: Configuration updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  new_config:
                    type: object
                    additionalProperties: true
        '422':
          $ref: '#/components/responses/ValidationError'

  /api/alba/metrics:
    get:
      summary: Get ALBA metrics
      tags:
        - ALBA
      description: Get data collection performance metrics
      responses:
        '200':
          description: Metrics retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AlbaMetricsResponse'

  /api/alba/health:
    get:
      summary: ALBA health check
      tags:
        - ALBA
      description: Check ALBA module health status
      responses:
        '200':
          description: Health check completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AlbaHealthResponse'
